<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sinh Nhật Nhiệm Màu - Enchanted Forest</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Quicksand:wght@300;500&display=swap" rel="stylesheet">
    <style>
        /* =========================================
           CSS STYLES - GIAO DIỆN CHÍNH
           ========================================= */
        :root {
            --gold: #ffd700;
            --magic-purple: #b300ff;
            --deep-bg: #0a0a2a;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            background: linear-gradient(to bottom, #020111, #110a2e, #0a2e1d);
            height: 100vh;
            overflow: hidden;
            font-family: 'Quicksand', sans-serif;
            position: relative;
        }

        /* Lớp phủ rừng cây mờ ảo phía sau */
        .forest-bg {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 50%;
            background-image: url('https://i.imgur.com/7QSZH9Z.png'); /* Ảnh silouhette rừng cây */
            background-repeat: repeat-x;
            background-position: bottom;
            background-size: auto 100%;
            opacity: 0.3;
            z-index: 1;
            pointer-events: none;
        }

        /* Các lớp Canvas */
        #bg-canvas, #burst-canvas, #mouse-trail-canvas {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
        }
        #bg-canvas { z-index: 2; opacity: 0.6; } /* Đom đóm nền */
        #mouse-trail-canvas { z-index: 3; } /* Vệt chuột */
        #burst-canvas { z-index: 4; mix-blend-mode: screen; } /* Vụ nổ phép thuật */

        /* Container chứa ảnh bay */
        #bubble-container {
            position: absolute;
            width: 100%; height: 100%;
            z-index: 5;
            pointer-events: none;
        }

        /* Style cho quả cầu ảnh */
        .photo-bubble {
            position: absolute;
            bottom: -150px;
            border-radius: 50%;
            overflow: hidden;
            box-shadow: 
                0 0 10px var(--gold),
                inset 0 0 20px var(--magic-purple);
            border: 2px solid rgba(255, 215, 0, 0.5);
            animation: bubbleRise linear forwards, gentleRotate 20s infinite linear;
            will-change: transform;
        }

        .photo-bubble img {
            width: 100%; height: 100%;
            object-fit: cover;
            opacity: 0.9;
        }

        /* Animation cho ảnh */
        @keyframes bubbleRise {
            to { transform: translateY(-130vh) translateX(var(--sway-end)); opacity: 0; }
        }
        @keyframes gentleRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Nội dung chữ chính */
        .main-content {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
            text-align: center;
            color: var(--gold);
            pointer-events: none;
            text-shadow: 0 2px 10px rgba(0,0,0,0.8);
        }

        h1.magic-title {
            font-family: 'Cinzel Decorative', cursive;
            font-size: 5rem;
            margin-bottom: 20px;
            background: linear-gradient(to right, #fff, var(--gold), #fff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: titleGlow 3s ease-in-out infinite alternate;
        }

        p.magic-wish {
            font-size: 1.3rem;
            line-height: 1.8;
            max-width: 700px;
            background: rgba(0,0,0,0.4);
            padding: 20px;
            border-radius: 15px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            backdrop-filter: blur(5px);
        }

        @keyframes titleGlow {
            from { filter: drop-shadow(0 0 5px var(--gold)); }
            to { filter: drop-shadow(0 0 25px var(--magic-purple)); }
        }
        
        /* Hiệu ứng mặt nước ở đáy */
        .water-surface {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 80px;
            background: linear-gradient(to top, rgba(10, 46, 29, 0.8), transparent);
            z-index: 6;
            filter: blur(10px);
        }

    </style>
</head>
<body>

    <div class="forest-bg"></div>
    <canvas id="bg-canvas"></canvas>
    <canvas id="mouse-trail-canvas"></canvas>
    <canvas id="burst-canvas"></canvas>
    
    <div id="bubble-container"></div>
    <div class="water-surface"></div>

    <div class="main-content">
        <h1 class="magic-title">Happy Birthday</h1>
        <p class="magic-wish">Chào mừng đến với khu rừng nhiệm màu! Chúc bạn một tuổi mới tràn đầy phép màu, vẻ đẹp và những điều kỳ diệu. Mong mọi ước nguyện của bạn sẽ bay cao và tỏa sáng như những tinh linh đêm nay.</p>
    </div>


    <script>
        // =================================================================
        // KHU VỰC CẤU HÌNH CỦA BẠN (THAY ĐỔI Ở ĐÂY)
        // =================================================================
        const CONFIG = {
            // Danh sách ảnh của bạn (Càng nhiều càng tốt)
            photos: [
                 "https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=400",
                 "https://images.unsplash.com/photo-1517841905240-472988babdf9?w=400",
                 "https://images.unsplash.com/photo-1524504388940-b1c1722653e1?w=400",
                 "https://images.unsplash.com/photo-1534528741775-53994a69daeb?w=400",
                 // Thêm link ảnh của bạn vào đây
            ],
            // Màu sắc chủ đạo cho các vụ nổ phép thuật (Hue: 0-360)
            magicColors: [50, 280, 200] // Vàng, Tím, Xanh ngọc
        };


        // =================================================================
        // PHẦN 1: HỆ THỐNG ẢNH QUẢ CẦU BAY (BUBBLE PHOTOS)
        // =================================================================
        const bubbleContainer = document.getElementById('bubble-container');

        function createMagicBubble() {
            if(document.hidden) return;

            const bubble = document.createElement('div');
            bubble.className = 'photo-bubble';
            
            const img = document.createElement('img');
            img.src = CONFIG.photos[Math.floor(Math.random() * CONFIG.photos.length)];
            bubble.appendChild(img);

            // Random kích thước (80px - 160px)
            const size = Math.random() * 80 + 80;
            bubble.style.width = `${size}px`;
            bubble.style.height = `${size}px`;

            // Random vị trí xuất phát ngang
            bubble.style.left = `${Math.random() * 90 + 5}%`;

            // Random độ lắc lư (sway) khi bay lên
            const swayEnd = (Math.random() - 0.5) * 200; // Lệch trái phải tối đa 100px
            bubble.style.setProperty('--sway-end', `${swayEnd}px`);

            // Random thời gian bay (bay chậm: 15s - 25s)
            const duration = Math.random() * 10 + 15;
            bubble.style.animationDuration = `${duration}s, ${Math.random() * 10 + 10}s`; // Bay và xoay

            bubbleContainer.appendChild(bubble);

            setTimeout(() => bubble.remove(), duration * 1000);
        }
        // Tạo ảnh mới mỗi 1.2 giây
        setInterval(createMagicBubble, 1200);


        // =================================================================
        // PHẦN 2: HỆ THỐNG CANVAS (Đom đóm, Vệt chuột, Nổ phép thuật)
        // =================================================================
        const bgCanvas = document.getElementById('bg-canvas');
        const bgCtx = bgCanvas.getContext('2d');
        const burstCanvas = document.getElementById('burst-canvas');
        const burstCtx = burstCanvas.getContext('2d');
        const trailCanvas = document.getElementById('mouse-trail-canvas');
        const trailCtx = trailCanvas.getContext('2d');

        let width, height;
        function resizeCanvases() {
            width = window.innerWidth;
            height = window.innerHeight;
            bgCanvas.width = burstCanvas.width = trailCanvas.width = width;
            bgCanvas.height = burstCanvas.height = trailCanvas.height = height;
        }
        window.addEventListener('resize', resizeCanvases);
        resizeCanvases();

        // --- Class Hạt cơ bản (Dùng chung) ---
        class Particle {
            constructor(x, y, hue, speedMult = 1, sizeMult = 1) {
                this.x = x; this.y = y;
                this.hue = hue;
                this.angle = Math.random() * Math.PI * 2;
                this.speed = Math.random() * speedMult;
                this.vx = Math.cos(this.angle) * this.speed;
                this.vy = Math.sin(this.angle) * this.speed;
                this.size = Math.random() * sizeMult + 1;
                this.alpha = 1;
                this.decay = Math.random() * 0.02 + 0.01;
                this.gravity = 0.02;
            }
            update() {
                this.x += this.vx; this.y += this.vy + this.gravity;
                this.vx *= 0.96; this.vy *= 0.96; // Ma sát
                this.alpha -= this.decay;
            }
            draw(ctx) {
                ctx.globalAlpha = this.alpha;
                ctx.fillStyle = `hsla(${this.hue}, 100%, 70%, ${this.alpha})`;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.globalAlpha = 1;
            }
        }

        let bursts = []; // Mảng chứa các hạt nổ
        let fireflies = []; // Mảng đom đóm
        let trailParticles = []; // Mảng vệt chuột

        // --- Tạo vụ nổ phép thuật ---
        function createMagicalBurst(x, y) {
            const hue = CONFIG.magicColors[Math.floor(Math.random() * CONFIG.magicColors.length)];
            for(let i = 0; i < 50; i++) {
                // Tốc độ nhanh hơn, kích thước lớn hơn cho vụ nổ
                bursts.push(new Particle(x, y, hue + Math.random()*40 - 20, 6, 3));
            }
        }
        
        // Tự động tạo vụ nổ ngẫu nhiên
        setInterval(() => {
            createMagicalBurst(Math.random() * width, Math.random() * height * 0.7);
        }, 1500);

        burstCanvas.addEventListener('click', (e) => createMagicalBurst(e.clientX, e.clientY));


        // --- Tạo đom đóm nền ---
        for(let i = 0; i < 100; i++) {
            fireflies.push({
                x: Math.random() * width,
                y: Math.random() * height,
                size: Math.random() * 2,
                speedY: Math.random() * 0.5 - 0.25, // Bay lên xuống chậm
                speedX: Math.random() * 0.4 - 0.2,
                alpha: Math.random(),
                alphaChange: Math.random() * 0.02 - 0.01
            });
        }

        // --- Xử lý vệt chuột ---
        let mouseX = 0, mouseY = 0;
        window.addEventListener('mousemove', (e) => {
            mouseX = e.clientX; mouseY = e.clientY;
            // Tạo hạt khi di chuột
            for(let i=0; i<2; i++) {
                 trailParticles.push(new Particle(mouseX, mouseY, 50, 2, 1.5)); // Màu vàng
            }
        });


        // =================================================================
        // VÒNG LẶP HOẠT HÌNH CHÍNH (RENDER LOOP)
        // =================================================================
        function animate() {
            // 1. Render Đom đóm (Background)
            bgCtx.clearRect(0, 0, width, height);
            bgCtx.fillStyle = '#ffd700'; // Màu vàng đom đóm
            fireflies.forEach(f => {
                f.y -= f.speedY; f.x += f.speedX;
                f.alpha += f.alphaChange;
                if(f.alpha <= 0 || f.alpha >= 1) f.alphaChange *= -1; // Nhấp nháy
                if(f.y < 0) f.y = height; if(f.y > height) f.y = 0; // Lặp lại vị trí
                bgCtx.globalAlpha = f.alpha;
                bgCtx.beginPath(); bgCtx.arc(f.x, f.y, f.size, 0, Math.PI*2); bgCtx.fill();
            });
            bgCtx.globalAlpha = 1;

            // 2. Render Vụ nổ phép thuật
            burstCtx.globalCompositeOperation = 'destination-out';
            burstCtx.fillStyle = 'rgba(0, 0, 0, 0.1)'; // Tạo vệt mờ nhẹ
            burstCtx.fillRect(0, 0, width, height);
            burstCtx.globalCompositeOperation = 'lighter';
            bursts.forEach((p, i) => {
                p.update(); p.draw(burstCtx);
                if(p.alpha <= 0) bursts.splice(i, 1);
            });

             // 3. Render Vệt chuột
            trailCtx.clearRect(0, 0, width, height);
            trailCtx.globalCompositeOperation = 'lighter';
             trailParticles.forEach((p, i) => {
                p.update(); p.draw(trailCtx);
                p.size *= 0.95; // Thu nhỏ dần
                if(p.alpha <= 0) trailParticles.splice(i, 1);
            });

            requestAnimationFrame(animate);
        }
        animate();

    </script>
</body>
</html>
